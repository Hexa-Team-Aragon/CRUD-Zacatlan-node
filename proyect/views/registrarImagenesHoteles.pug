extends ./layout/index.pug
block compartircontenido 
    main.container.mt-5
        .row 
            form(id='uploadForm' enctype='multipart/form-data' method="POST")
                .form-group
                    label(for="Archivo") Archivo 
                    input#myFiles(type="file", accept='image/*' multiple)
                input.btn.btn-success.btn-block(type="submit" value='Subir Archivo')
        h2#status
        h3
        script.
            const form = document.getElementById('uploadForm')

            const sendFiles = async () =>{

                const myFiles = document.getElementById('myFiles').files

                const formData = new FormData()

                Object.keys(myFiles).forEach(key =>{
                    formData.append(myFiles.item(key).name, myFiles.item(key))
                })
                const response = await fetch('http://localhost:1800/pagRegistrarImagenesHoteles', {
                    method: 'POST',
                    body: formData
                }) 

                const json = await response.json()

                const h2 =  document.querySelector('h2')
                h2.textContent = json?.status

                const h3 =  document.querySelector('h3')
                h3.textContent = json?.message

                if (json?.status === "success"){
                    console.log('entro')
                    location.assign(json?.ruta)
                }else{
                    console.log('no entro')
                }

            }
            form.addEventListener('submit', (e) => {
                e.preventDefault()
                sendFiles()
            })